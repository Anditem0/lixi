<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>L√¨ X√¨ B√≠nh Ng·ªç 2026</title>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Be+Vietnam+Pro:wght@400;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>L√å X√å B√çNH NG·ªå 2026 üßß</h1>
  <div id="status-text" class="instruction">Ch·ªçn 1 t·ªù - C√†o l·ªô v√πng s·ªë ti·ªÅn ƒë·ªÉ nh·∫≠n l·ªôc!</div>
  <div class="grid" id="grid"></div>
  <button id="reset-btn">L√ÄM M·ªöI B·ªò V√â</button>

  <div id="modal-overlay">
    <div class="modal">
      <h2 id="modal-title"></h2>
      <p id="modal-msg"></p>
      <p id="comment-msg" style="font-style: italic; color: #8b0000; margin: 10px 0;"></p>
      <button onclick="nextRound()">TI·∫æP T·ª§C CH·ªåN V√â</button>
    </div>
  </div>

  <script>
    const PRIZES = [
      { val: 10000, title: "Cu Em  Qu√° H√™n Lun !!", weight: 45, type: 'small' },
      { val: 20000, title: "Qu√° ƒê·ªânh, ƒê∆∞·ª£c Nh·ªØng T√¢n 20k :))", weight: 30, type: 'medium' },
      { val: 50000, title: "Ch·∫Øc ƒê·ªß Ti·ªÅn N·∫°p Fai Fai R·ªìi", weight: 15, type: 'medium' },
      { val: 100000, title: "D√πng H·∫øt V·∫≠n May C·∫£ Ng√†y R·ªìi", weight: 6, type: 'large' },
      { val: 200000, title: "ƒê·ªânh N√≥c, K·ªãch Tr·∫ßn Bay Ph·∫•p B·ªõi", weight: 3, type: 'large' },
      { val: 500000, title: "V·ªù L·ªù, ·∫¢o Th·∫≠t ƒê·∫•y", weight: 1, type: 'jackpot' }
    ];
    const WISHES = [
      "V·∫°n S·ª± Nh∆∞ √ù", "Ph√°t T√†i Ph√°t L·ªôc", "S·ª©c Kh·ªèe D·ªìi D√†o", "An Khang Th·ªãnh V∆∞·ª£ng",
      "Cung h·ª∑ ph√°t t√†i", "Ph√∫c l·ªôc ƒë·∫ßy nh√†", "B√¨nh an m·∫°nh kh·ªèe", "T√¢n ni√™n ƒë·∫°i c√°t"
    ];

    // C√¢u tr√™u ri√™ng cho 10k
    const tease10k = [
      "10k th√¥i h·∫£? ƒê·ªß mua b·ªãch bim bim v·ªã cay, nhai cho ƒë·ª° th√®m l·ªôc l·ªõn!",
      "Tr√∫ng 10k, ch·∫Øc ki·∫øp tr∆∞·ªõc b·∫°n cho tui xin 1k ƒëi ƒÉn s√°ng, gi·ªù tr·∫£ l√£i ƒë√¢y haha!",
      "10k √†? ƒê·ªß ƒë·ªï xƒÉng xe ƒë·∫°p ƒëi xin l√¨ x√¨ nh√† h√†ng x√≥m th√¥i, c·ªë l√™n nƒÉm sau nh√©!",
      "L·ªôc nh·ªè t√≠ teo nh∆∞ c√°i que kem que, nh∆∞ng T·∫øt m√†, c√≥ c√≤n h∆°n kh√¥ng ƒë√∫ng hem?",
      "10k n√†y ch·∫Øc ƒë·ªÉ mua... 1 c√¢y k·∫πo m√∫t, c√≤n l·∫°i ƒë·ªÉ d√†nh hy v·ªçng tr√∫ng l·ªõn ti·∫øp!"
    ];

    // C√¢u tr√™u ri√™ng cho 20k
    const tease20k = [
      "20k? ƒê·ªß ti·ªÅn mua g√≥i m√¨ t√¥m cao c·∫•p ƒÉn T·∫øt, nh∆∞ng ƒë·ª´ng c√≥ khoe v·ªõi ai nha!",
      "Tr√∫ng 20k, ch·∫Øc b·∫°n n·ª£ tui 19k t·ª´ ki·∫øp tr∆∞·ªõc, gi·ªù tr·∫£ c√≥ l√£i r·ªìi ƒë√≥!",
      "20k th√¥i m√†, ƒë·ªß mua 1 c·ªëc tr√† s·ªØa size nh·ªè, u·ªëng xong bu·ªìn v√¨ kh√¥ng tr√∫ng l·ªõn h∆°n!",
      "20k √†? ·ª¶a sao kh√¥ng tr√∫ng 200k lu√¥n cho r·ªìi, ƒë·ªÉ tui c√≤n ƒë∆∞·ª£c k√© k√© k√©!",
      "L·ªôc 20k nh∆∞ ki·ªÉu 'c√≥ ti·ªÅn nh∆∞ng ch∆∞a gi√†u', T·∫øt vui l√† ƒë∆∞·ª£c r·ªìi ha!"
    ];

    // C√¢u tr√™u ri√™ng cho 50k
    const tease50k = [
      "50k? ƒê·ªß ti·ªÅn ƒë·ªï xƒÉng xe m√°y ƒëi ch∆°i T·∫øt, nh∆∞ng ƒë·ª´ng c√≥ ƒëi xa qu√° k·∫ªo h·∫øt ti·ªÅn v·ªÅ!",
      "Tr√∫ng 50k, ch·∫Øc b·∫°n ƒëang nghƒ© 'th√¥i c≈©ng ƒë∆∞·ª£c, mua √≠t b√°nh ch∆∞ng ƒÉn t·∫°m' hahaha!",
      "50k √†? Sao kh√¥ng tr√∫ng 500k lu√¥n cho r·ªìi, ƒë·ªÉ tui c√≤n ƒë∆∞·ª£c nh·ªù mua v√© s·ªë k√©!",
      "L·ªôc 50k nh∆∞ ki·ªÉu 'g·∫ßn gi√†u nh∆∞ng ch∆∞a t·ªõi', c·ªë l√™n l·∫ßn sau nh√© √¥ng b·∫°n!",
      "50k n√†y ch·∫Øc ƒë·ªÉ mua... 1 chai bia T·∫øt, u·ªëng xong bu·ªìn v√¨ kh√¥ng tr√∫ng √¥ng ho√†ng!"
    ];

    // C√¢u khen cho gi·∫£i l·ªõn
    const praiseComments = [
      "Wow, may m·∫Øn qu√° tr·ªùi, ch√∫c m·ª´ng b·∫°n nh√©!",
      "ƒê·∫°i l·ªôc ƒë·∫øn tay, nƒÉm m·ªõi gi√†u sang ƒë√¢y!",
      "B·∫°n l√† √¥ng ho√†ng l·ªôc l√°, tuy·ªát v·ªùi qu√°!",
      "Tr√∫ng l·ªõn r·ªìi, ch√∫c nƒÉm B√≠nh Ng·ªç ƒë·∫°i ph√°t!",
      "L·ªôc ƒë·∫ßy nh√†, may m·∫Øn li√™n t·ª•c cho b·∫°n!"
    ];

    let isAnyCardActive = false;

    function getRandomComment(val) {
      let comments;
      if (val === 10000) comments = tease10k;
      else if (val === 20000) comments = tease20k;
      else if (val === 50000) comments = tease50k;
      else comments = praiseComments;
      return comments[Math.floor(Math.random() * comments.length)];
    }

    function createCard(container, wish) {
      const prizeObj = (() => {
        let total = PRIZES.reduce((sum, prize) => sum + prize.weight, 0);
        let random = Math.random() * total;
        for (let prize of PRIZES) {
          if (random < prize.weight) return prize;
          random -= prize.weight;
        }
        return PRIZES[0];
      })();

      const wrapper = document.createElement('div');
      wrapper.className = 'card-container';
      wrapper.innerHTML = `
        <div class="card-inner">
          <div class="card-front">
            <div class="corner top-left"></div>
            <div class="corner bottom-right"></div>
            <div class="emblem">üßß</div>
            <div class="year-text">2026</div>
            <div style="font-size:0.7rem; color:var(--gold); margin-top:5px; font-weight:bold;">CH√öC M·ª™NG NƒÇM M·ªöI</div>
          </div>
          <div class="card-back">
            <div class="card-content">
              <div style="font-size:0.7rem; font-weight:bold; color:#8b0000">L·ªòC XU√ÇN</div>
              <div class="amount">${prizeObj.val.toLocaleString()}ƒë</div>
            </div>
            <canvas width="165" height="235"></canvas>
          </div>
        </div>
      `;

      const canvas = wrapper.querySelector('canvas');
      const ctx = canvas.getContext('2d', { willReadFrequently: true });
      let isDrawing = false, isCleared = false;

      function drawCover() {
        const grd = ctx.createLinearGradient(0, 0, 165, 235);
        grd.addColorStop(0, '#f1c40f'); grd.addColorStop(1, '#d4af37');
        ctx.fillStyle = grd; ctx.fillRect(0, 0, 165, 235);
        ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
        ctx.font = '24px "Great Vibes", cursive'; ctx.fillStyle = '#8b0000';
        const words = wish.split(' ');
        ctx.fillText(words.slice(0, Math.ceil(words.length/2)).join(' '), 82, 90);
        ctx.fillText(words.slice(Math.ceil(words.length/2)).join(' '), 82, 130);
        ctx.font = 'bold 10px Arial'; ctx.fillText('C√ÄO V√ôNG TRUNG T√ÇM', 82, 200);
      }
      document.fonts.ready.then(drawCover);

      const flipCard = () => {
        if (isAnyCardActive || wrapper.classList.contains('flipped')) return;
        isAnyCardActive = true;
        wrapper.classList.add('flipped');
        document.querySelectorAll('.card-container').forEach(c => c !== wrapper && c.classList.add('locked'));
        drawCover();
      };

      wrapper.onclick = flipCard;
      wrapper.ontouchend = (e) => {
        e.preventDefault();
        flipCard();
      };

      function scratch(e) {
        if (!isDrawing || isCleared || !wrapper.classList.contains('flipped')) return;
        const rect = canvas.getBoundingClientRect();
        const clientX = e.clientX || (e.touches && e.touches[0].clientX);
        const clientY = e.clientY || (e.touches && e.touches[0].clientY);
        const x = (clientX - rect.left) * (canvas.width / rect.width);
        const y = (clientY - rect.top) * (canvas.height / rect.height);
        ctx.globalCompositeOperation = 'destination-out';
        ctx.beginPath(); ctx.arc(x, y, 25, 0, Math.PI * 2); ctx.fill();
        const imgData = ctx.getImageData(30, 80, 100, 70);
        let clear = 0;
        for (let i = 3; i < imgData.data.length; i += 4) if (imgData.data[i] === 0) clear++;
        if (clear > (imgData.data.length / 4) * 0.8) {
          isCleared = true;
          canvas.style.transition = "opacity 0.6s"; canvas.style.opacity = '0';
          setTimeout(() => {
            canvas.remove();
            shootFireworks(prizeObj.type);
            document.getElementById('modal-title').innerText = prizeObj.title;
            document.getElementById('modal-msg').innerText = `Ch√∫c m·ª´ng b·∫°n nh·∫≠n ƒë∆∞·ª£c ${prizeObj.val.toLocaleString()}ƒë!`;
            document.getElementById('comment-msg').innerText = getRandomComment(prizeObj.val);
            document.getElementById('modal-overlay').style.display = 'flex';
          }, 400);
        }
      }

      canvas.onmousedown = () => isDrawing = true;
      canvas.ontouchstart = (e) => { isDrawing = true; e.preventDefault(); };
      window.onmouseup = () => isDrawing = false;
      window.ontouchend = () => isDrawing = false;
      canvas.onmousemove = scratch;
      canvas.ontouchmove = (e) => { scratch(e); e.preventDefault(); };

      container.appendChild(wrapper);
    }

    function shootFireworks(type) {
      const colors = ['#f1c40f', '#e74c3c', '#ffffff', '#ff9f43'];
      if (type === 'small') confetti({ particleCount: 40, spread: 50, origin: { y: 0.7 } });
      else if (type === 'medium') confetti({ particleCount: 120, spread: 80, origin: { y: 0.6 } });
      else if (type === 'large') confetti({ particleCount: 300, spread: 120, origin: { y: 0.6 }, scalar: 1.2, colors });
      else if (type === 'jackpot') {
        const end = Date.now() + 5000;
        (function frame() {
          confetti({ particleCount: 20, angle: 60, spread: 100, origin: { x: 0, y: 0.6 }, colors, scalar: 1.4 });
          confetti({ particleCount: 20, angle: 120, spread: 100, origin: { x: 1, y: 0.6 }, colors, scalar: 1.4 });
          confetti({ particleCount: 25, angle: 90, spread: 160, origin: { x: 0.5, y: 0.7 }, colors, scalar: 1.6 });
          if (Date.now() < end) requestAnimationFrame(frame);
        }());
      }
    }

    function nextRound() {
      document.getElementById('modal-overlay').style.display = 'none';
      isAnyCardActive = false;
      document.querySelectorAll('.card-container').forEach(c => c.classList.remove('locked'));
    }

    function start() {
      const grid = document.getElementById('grid');
      grid.innerHTML = '';
      isAnyCardActive = false;
      let shuffled = [...WISHES].sort(() => Math.random() - 0.5);
      for (let i = 0; i < 6; i++) createCard(grid, shuffled[i]);
    }

    document.getElementById('reset-btn').onclick = start;
    start();
  </script>
</body>
</html>
